---
title: å…­å¤§åŸåˆ™
time: 2022-12-16
---

## å•ä¸€èŒè´£åŸåˆ™

### åŸºæœ¬ä»‹ç»

å•ä¸€èŒè´£åŸåˆ™ï¼ˆSingle Responsibility Principleï¼ŒSRPï¼‰åˆç§°å•ä¸€åŠŸèƒ½åŸåˆ™ï¼Œæ˜¯é¢å‘å¯¹è±¡çš„äº”ä¸ªåŸºæœ¬åŸåˆ™ï¼ˆSOLIDï¼‰ä¹‹ä¸€ã€‚å®ƒè§„å®šä¸€ä¸ªç±»åº”è¯¥åªæœ‰ä¸€ä¸ªå‘ç”Ÿå˜åŒ–çš„åŸå› ã€‚

**èŒè´£**æŒ‡çš„æ˜¯ç±»å˜åŒ–çš„åŸå› ï¼Œä¹Ÿå°±æ˜¯ä¸šåŠ¡éœ€æ±‚ã€‚å¦‚æœä¸€ä¸ªç±»æœ‰å¤šäºä¸€ä¸ªçš„åŸå› è¢«æ”¹å˜ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»å‹å°±æœ‰è¶…è¿‡ä¸¤ä¸ªåŠä»¥ä¸Šçš„èŒè´£ã€‚è€Œå•ä¸€èŒè´£çº¦å®šä¸€ä¸ªç±»åº”è¯¥æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªæ”¹å˜ç±»çš„åŸå› ã€‚

å¦‚æœéœ€è¦å¼€å‘çš„ä¸€ä¸ªåŠŸèƒ½éœ€è¦ä¸æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œä¸”éšç€ä¸šåŠ¡å‘å±•çš„ä¸æ–­å˜åŒ–è€Œå˜åŒ–ï¼Œé‚£ä¹ˆå½“ä¸€ä¸ª Class ç±»è´Ÿè´£è¶…è¿‡ä¸¤ä¸ªåŠä»¥ä¸Šçš„èŒè´£æ—¶ï¼Œåœ¨éœ€æ±‚çš„ä¸æ–­è¿­ä»£ã€å®ç°ç±»æŒç»­æ‰©å¼ çš„æƒ…å†µä¸‹ï¼Œå°±ä¼šå‡ºç°éš¾ä»¥ç»´æŠ¤ã€ä¸å¥½æ‰©å±•ã€æµ‹è¯•éš¾åº¦å¤§å’Œä¸Šçº¿é£é™©é«˜ç­‰é—®é¢˜ã€‚

### æ¨¡æ‹Ÿåœºæ™¯

**åœºæ™¯**ï¼šå½“åœ¨å„ç±»è§†é¢‘ç½‘ç«™çœ‹ç”µå½±ã€ç”µè§†å‰§æ—¶ï¼Œç½‘ç«™é’ˆå¯¹ä¸åŒçš„ç”¨æˆ·ç±»å‹ï¼Œä¼šåœ¨ç”¨æˆ·è§‚çœ‹æ—¶ç»™å‡ºä¸åŒçš„æœåŠ¡åé¦ˆï¼Œå¦‚ä»¥ä¸‹ä¸‰ç§ã€‚

- è®¿é—®ç”¨æˆ·ï¼Œä¸€èˆ¬åªå¯ä»¥è§‚çœ‹ 480P è§†é¢‘ï¼Œå¹¶æ—¶åˆ»æé†’ç”¨æˆ·æ³¨å†Œä¼šå‘˜èƒ½è§‚çœ‹é«˜æ¸…è§†é¢‘ã€‚è¿™è¡¨ç¤ºè§†é¢‘ä¸šåŠ¡å‘å±•éœ€è¦æ‹‰å®¢ï¼Œä»¥è·å–æ›´å¤šçš„æ–°æ³¨å†Œç”¨æˆ·ã€‚
- æ™®é€šä¼šå‘˜ï¼Œå¯ä»¥è§‚çœ‹ 720P è¶…æ¸…è§†é¢‘ï¼Œä½†ä¸èƒ½å±è”½è§†é¢‘ä¸­å‡ºç°çš„å¹¿å‘Šã€‚è¿™è¡¨ç¤ºè§†é¢‘ä¸šåŠ¡å‘å±•éœ€è¦ç›ˆåˆ©ã€‚
- VIP ä¼šå‘˜ï¼ˆå±äºä»˜è´¹ç”¨æˆ·ï¼‰ï¼Œæ—¢å¯ä»¥è§‚çœ‹ 1080P è“å…‰è§†é¢‘ï¼Œåˆå¯ä»¥å…³é—­æˆ–è·³è¿‡å¹¿å‘Šã€‚

#### è¿èƒŒåŸåˆ™æ–¹æ¡ˆ

**ğŸ‘†åœºæ™¯å®ç°ï¼š**æ ¹æ®ä¸åŒçš„ç”¨æˆ·ç±»å‹ï¼Œåˆ¤æ–­ç”¨æˆ·å¯ä»¥è§‚çœ‹è§†é¢‘çš„ç±»å‹ã€‚

~~~ java
public class VideoUserService {
    public void serveGrade(String userType){
        if ("VIPç”¨æˆ·".equals(userType)){
            System.out.println("VIPç”¨æˆ·ï¼Œè§†é¢‘1080Pè“å…‰");
        } else if ("æ™®é€šç”¨æˆ·".equals(userType)){
            System.out.println("æ™®é€šç”¨æˆ·ï¼Œè§†é¢‘720Pè¶…æ¸…");
        } else if ("è®¿å®¢ç”¨æˆ·".equals(userType)){
            System.out.println("è®¿å®¢ç”¨æˆ·ï¼Œè§†é¢‘480Pé«˜æ¸…");
        }
    }
}
~~~

**æµ‹è¯•ï¼š**

~~~ java
 @Test
    public void test_serveGrade(){
        VideoUserService service = new VideoUserService();
        service.serveGrade("VIPç”¨æˆ·");
        service.serveGrade("æ™®é€šç”¨æˆ·");
        service.serveGrade("è®¿å®¢ç”¨æˆ·");
    }
~~~

>**å°ç»“ï¼š**
>
>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œä¸€ä¸ªç±»é‡Œé¢åŒ…å«ç€å¤šä¸ªä¸åŒçš„è¡Œä¸ºï¼Œä¹Ÿå°±æ˜¯å¤šç§ç”¨æˆ·èŒè´£ã€‚å¦‚æœåœ¨è¿™æ ·ç±»çš„ä¸Šç»§ç»­æ‰©å±•åŠŸèƒ½æˆ–é€»è¾‘ï¼Œå°±ä¼šæ˜¾å¾—éå¸¸è‡ƒè‚¿ã€‚
>
>åŒæ—¶ä¸Šé¢çš„å®ç°æ–¹å¼æ˜¯åœ¨ä¸€ä¸ªç±»ä¸­ç”¨ if...else if....else åˆ¤æ–­é€»è¾‘ï¼Œæ‰€åœ¨åœ¨è°ƒç”¨æ–¹å¼æ—¶æ˜¯æ‰€æœ‰çš„èŒè´£ç”¨æˆ·éƒ½ä½¿ç”¨ä¸€ä¸ªæ–¹æ³•å®ç°ã€‚å¯¹äºç®€å•çš„æˆ–è€…ä¸éœ€è¦è¿­ä»£çš„åŠŸèƒ½ï¼Œä¹Ÿè¿™æ ·çš„å®ç°æœªå°ä¸å¯ï¼Œä½†å¯¹äºå¤æ‚çš„ä¸šåŠ¡éœ€æ±‚ï¼Œè¿™ç§ä»£ç ç»“æ„ä¸åˆ©äºåæœŸçš„è¿­ä»£ï¼Œä¸”æ¯æ¬¡éœ€æ±‚çš„å˜æ›´éƒ½å¯ä»¥å½±å“åˆ°å…¶ä»–çš„é€»è¾‘ï¼Œç»™æ•´ä¸ªæ¥å£æœåŠ¡å¸¦æ¥ä¸å¯æ§çš„é£é™©ã€‚

#### å•ä¸€èŒè´£åŸåˆ™æ”¹å–„ä»£ç 

é’ˆå¯¹ä¸Šè¿°å‡ºç°ä¸€ä¸ªç±»ä¸­æœ‰å¤šä¸ªèŒè´£çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥æä¾›ä¸€ä¸ªä¸Šå±‚çš„æ¥å£ç±»ï¼Œå¯¹ä¸åŒå·®å¼‚åŒ–ç”¨æˆ·ç»™å‡ºå•ç‹¬çš„å®ç°ç±»ï¼Œæ‹†åˆ†å„è‡ªçš„èŒè´£è¾¹ç•Œï¼ŒåŒæ—¶ä¹Ÿæ»¡è¶³æˆ‘ä»¬åæœŸçš„è¿­ä»£éœ€æ±‚ã€‚

**å®šä¹‰æ¥å£**

å®šä¹‰å‡ºä¸Šå±‚æ¥å£ IVideoUserServiceï¼Œç»Ÿä¸€å®šä¹‰éœ€è¦å®ç°çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼šè§†é¢‘æ¸…æ™°çº§åˆ«æ¥å£ definition()ã€å¹¿å‘Šæ’­æ”¾æ–¹å¼æ¥å£ advertisement()ã€‚ä¸‰ç§ä¸åŒç±»å‹çš„ç”¨æˆ·å°±å¯ä»¥åˆ†åˆ«å®ç°è‡ªå·±çš„æœåŠ¡ç±»ï¼Œåšåˆ°èŒè´£ç»Ÿä¸€ã€‚

~~~ java
public interface IVideoUserService {
    // è§†é¢‘æ¸…æ™°çº§åˆ«ï¼›480Pã€720Pã€1080P
    void definition();

    // å¹¿å‘Šæ’­æ”¾æ–¹å¼ï¼›æ— å¹¿å‘Šã€æœ‰å¹¿å‘Š
    void advertisement();
}
~~~

**å®ç°æ¥å£**

**è®¿å®¢ç”¨æˆ·ç±»ï¼š**

~~~ java
/**
 * ç”¨æˆ·ç±»å‹ï¼šè®¿å®¢ç”¨æˆ·
 */
public class GuestVideoUserService implements IVideoUserService {

    @Override
    public void definition() {
        System.out.println("è®¿å®¢ç”¨æˆ·ï¼Œè§†é¢‘480Pé«˜æ¸…");
    }

    @Override
    public void advertisement() {
        System.out.println("è®¿å®¢ç”¨æˆ·ï¼Œè§†é¢‘æœ‰å¹¿å‘Š");
    }
}
~~~



**æ™®é€šç”¨æˆ·ç±»ï¼š**

~~~ java
public class OrdinaryVideoUserService implements IVideoUserService {

    @Override
    public void definition() {
        System.out.println("æ™®é€šç”¨æˆ·ï¼Œè§†é¢‘720Pè¶…æ¸…");
    }

    @Override
    public void advertisement() {
        System.out.println("æ™®é€šç”¨æˆ·ï¼Œè§†é¢‘æœ‰å¹¿å‘Š");
    
}
~~~



**VIP ç”¨æˆ·ç±»**

~~~ java
public class VipVideoUserService implements IVideoUserService {

    @Override
    public void definition() {
        System.out.println("VIPç”¨æˆ·ï¼Œè§†é¢‘1080Pè“å…‰");
    }

    @Override
    public void advertisement() {
        System.out.println("VIPç”¨æˆ·ï¼Œè§†é¢‘æ— å¹¿å‘Š");
    }
}
~~~



**æµ‹è¯•**

~~~ java
    @Test
    public void test_VideoUserService(){

        IVideoUserService guest = new GuestVideoUserService();
        guest.definition();
        guest.advertisement();

        IVideoUserService ordinary = new OrdinaryVideoUserService();
        ordinary.definition();
        ordinary.advertisement();

        IVideoUserService vip = new VipVideoUserService();
        vip.definition();
        vip.advertisement();

    }
~~~

<img src="https://qijiayi-image.oss-cn-shenzhen.aliyuncs.com/img/202212211505388.png" alt="image-20221221150514069" style="zoom: 50%;" />

> é€šè¿‡åˆ©ç”¨å•ä¸€èŒè´£åŸåˆ™çš„ä»£ç ä¼˜åŒ–åï¼Œç°åœ¨æ¯ä¸ªç±»åªè´Ÿè´£è‡ªå·±çš„ç”¨æˆ·è¡Œä¸ºã€‚åç»­æ— è®ºæ‰©å±•æ–°çš„åŠŸèƒ½è¿˜æ˜¯éœ€è¦åœ¨æŸä¸€æ—¶åˆ»ä¿®æ”¹æŸä¸ªç”¨æˆ·è¡Œä¸ºç±»ï¼Œéƒ½å¯ä»¥éå¸¸æ–¹ä¾¿åœ°å¼€å‘å’Œç»´æŠ¤ã€‚
>
> åœ¨é¡¹ç›®å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œå°½å¯èƒ½ä¿è¯æ¥å£çš„å®šä¹‰ã€ç±»çš„å®ç°ä»¥åŠæ–¹æ³•å¼€å‘ä¿æŒå•ä¸€èŒè´£ï¼Œå¯¹é¡¹ç›®åæœŸçš„è¿­ä»£å’Œç»´æŠ¤ä¼šæœ‰å¾ˆå¤§çš„å¸®åŠ©ã€‚

## å¼€é—­åŸåˆ™

### åŸºæœ¬ä»‹ç»

å¼€é—­åŸåˆ™è§„å®šè½¯ä»¶ä¸­çš„å¯¹è±¡ã€ç±»ã€æ¨¡å—ã€å‡½æ•°å¯¹æ‰©å±•åº”è¯¥æ˜¯å¼€æ”¾çš„ï¼Œä½†**å¯¹äºä¿®æ”¹æ—¶å°é—­çš„**ã€‚è¿™æ„å‘³ç€åº”è¯¥ç”¨**æŠ½è±¡**å®šä¹‰ç»“æ„ï¼Œç”¨å…·ä½“å®ç°æ‰©å±•ç»†èŠ‚ï¼Œä»¥æ­¤ç¡®ä¿è½¯ä»¶ç³»ç»Ÿå¼€å‘å’Œç»´æŠ¤è¿‡ç¨‹çš„å¯é æ€§ã€‚

å¼€é—­åŸåˆ™çš„æ ¸å¿ƒæ€æƒ³ä¹Ÿå¯ä»¥ç†è§£ä¸ºé¢å‘æŠ½è±¡ç¼–ç¨‹ã€‚

### æ¨¡æ‹Ÿåœºæ™¯

å¯¹äºå¤–éƒ¨çš„è°ƒç”¨æ–¹æ¥è¯´ï¼Œåªè¦èƒ½ä½“ç°å‡ºé¢å‘æŠ½è±¡ç¼–ç¨‹ï¼Œå®šä¹‰å‡ºæ¥å£å¹¶å®ç°å…¶æ–¹æ³•ï¼Œå³ä¸ä¿®æ”¹åŸæœ‰æ–¹æ³•ä½“ï¼Œåªé€šè¿‡ç»§æ‰¿æ–¹å¼è¿›è¡Œæ‰©å±•ï¼Œéƒ½å¯ä»¥ä½“ç°å‡ºå¼€é—­åŸåˆ™ã€‚

è®¡ç®—ä¸‰ç§å½¢çŠ¶çš„é¢ç§¯ï¼Œå¦‚é•¿æ–¹ä½“ã€ä¸‰è§’å½¢ã€åœ†å½¢ï¼Œå®ƒä»¬åœ¨ç±»ä¸­å·²ç»æŒ‰ç…§å›ºå®šçš„å…¬å¼å®ç°ï¼Œå…¶ä»–åœ†å½¢é¢ç§¯å…¬å¼ä¸­ Ï€=3.14ã€‚ä½†åç»­çš„ç”±äº Ï€ å€¼å–çš„ç²¾åº¦å¯¹äºæŸäº›åœºæ™¯æ˜¯ä¸è¶³çš„ï¼Œéœ€è¦æ‰©å±•ã€‚

**å®šä¹‰æ¥å£**

~~~ java
public interface ICalculationArea {

    /**
     * è®¡ç®—é¢ç§¯ï¼Œé•¿æ–¹å½¢
     *
     * @param x é•¿
     * @param y å®½
     * @return é¢ç§¯
     */
    double rectangle(double x, double y);

    /**
     * è®¡ç®—é¢ç§¯ï¼Œä¸‰è§’å½¢
     * @param x è¾¹é•¿x
     * @param y è¾¹é•¿y
     * @param z è¾¹é•¿z
     * @return  é¢ç§¯
     *
     * æµ·ä¼¦å…¬å¼ï¼šS=âˆš[p(p-a)(p-b)(p-c)] å…¶ä¸­ï¼šp=(a+b+c)/2
     */
    double triangle(double x, double y, double z);

    /**
     * è®¡ç®—é¢ç§¯ï¼Œåœ†å½¢
     * @param r åŠå¾„
     * @return é¢ç§¯
     *
     * åœ†é¢ç§¯å…¬å¼ï¼šS=Ï€rÂ²
     */
    double circular(double r);

}
~~~



- é•¿æ–¹å½¢é¢ç§¯ï¼Œé•¿xå®½
- ä¸‰è§’å½¢é¢ç§¯ï¼Œä½¿ç”¨æµ·ä¼¦å…¬å¼ï¼ŒS=âˆš[p(p-a)(p-b)(p-c)] å…¶ä¸­ï¼šp=(a+b+c)/2ã€‚
- åœ†å½¢é¢ç§¯ï¼ŒS=Ï€rÂ²

**å®ç°ç±»**

åœ¨å®ç°ç±»ä¸­ï¼Œåˆ†åˆ«å®ç°ä¸‰ç§ç±»å‹çš„é¢ç§¯è®¡ç®—ï¼Œé•¿æ–¹å½¢ï¼ˆrectangleï¼‰ã€ä¸‰è§’å½¢ï¼ˆtriangleï¼‰ã€åœ†å½¢ï¼ˆcircularï¼‰ã€‚å…¶ä¸­ï¼Œåœ†å½¢é¢ç§¯çš„ Ï€ å€¼å–çš„æ˜¯ 3.14*D*ï¼Œè¿™ä¹Ÿæ˜¯è¦æ‰©å±•ç²¾åº¦çš„æ–¹æ³•å’Œä½“ç°å¼€é—­åŸåˆ™çš„åœ°æ–¹ã€‚

~~~ javascript
public class CalculationArea implements ICalculationArea {

    private final static double Ï€ = 3.14D;

    @Override
    public double rectangle(double x, double y) {
        return x * y;
    }

    @Override
    public double triangle(double x, double y, double z) {
        double p = (x + y + z) / 2;
        return Math.sqrt(p * (p - x) * (p - y) * (p - z));
    }

    @Override
    public double circular(double r) {
        return Ï€ * r * r;
    }

}
~~~

#### è¿èƒŒåŸåˆ™æ–¹æ¡ˆ

å¦‚æœä¸è€ƒè™‘å¼€é—­åŸåˆ™ï¼Œä¹Ÿä¸æ€è€ƒè¿™ç§æ–¹æ³•åœ¨æ•´ä¸ªå·¥å‚æœåŠ¡ä¸­çš„ä½¿ç”¨æƒ…å†µï¼Œé‚£ä¹ˆç›´æ¥ä¿®æ”¹ Ï€ å€¼å°±å¯ä»¥äº†ï¼Œä½†è¿™æ ·åšå°±ä¼šç ´åæ•´ä¸ªå·¥ç¨‹æœåŠ¡çš„ç¨³å®šæ€§ï¼Œä¹Ÿå°±é€ æˆä¸€äº›é£é™©ã€‚

~~~~ java
private final static double Ï€ = 3.141592653D;
~~~~

#### å¼€é—­åŸåˆ™æ”¹å–„ä»£ç 

å¼€é—­åŸåˆ™ä¸»è¦ç›®çš„æ˜¯ä¸èƒ½å› ä¸ºä¸ªä¾‹éœ€æ±‚çš„å˜åŒ–è€Œæ”¹å˜é¢„å®šçš„å®ç°ç±»ã€‚é™¤éé¢„å®šçš„å®ç°ç±»æœ‰é”™è¯¯ã€‚

å®ç°çš„è¿‡ç¨‹æ˜¯ç»§ç»­çˆ¶ç±»æ‰©å±•éœ€è¦çš„æ–¹æ³•ï¼ŒåŒæ—¶ä¿ç•™åŸæœ‰çš„æ–¹æ³•ï¼Œæ–°å¢è‡ªå·±éœ€è¦çš„æ–¹æ³•ã€‚

æ‰©å±•çš„æ–¹æ³•ä»¥åŠå§æ±‚åœ†çš„é¢ç§¯çš„ç²¾åº¦å¢é•¿ï¼Œéœ€è¦ä½¿ç”¨æ­¤æ–¹æ³•çš„ç”¨æˆ·å¯ä»¥ç›´æ¥è°ƒç”¨ã€‚è€Œå…¶ä»–çš„æ–¹æ³•ï¼Œåˆ™å¯ä»¥ç»§ç»­ä½¿ç”¨ã€‚

~~~ java
public class CalculationAreaExt extends CalculationArea {

    private final static double Ï€ = 3.141592653D;

    @Override
    public double circular(double r) {
        return Ï€ * r * r;
    }
}
~~~

## é‡Œæ°æ›¿æ¢åŸåˆ™

### åŸºæœ¬ä»‹ç»

ç†æ°æ›¿æ¢åŸåˆ™ï¼ˆLiskov Substitution Principleï¼ŒLSPï¼‰ï¼Œç»§æ‰¿å¿…é¡»ç¡®ä¿è¶…ç±»æ‰€æ‹¥æœ‰çš„æ€§è´¨åœ¨å­ç±»ä¸­ä»ç„¶æˆç«‹ã€‚

**é‡Œæ°æ›¿æ¢åŸåˆ™**

å¦‚æœ S æ˜¯ T çš„å­ç±»ï¼Œé‚£ä¹ˆæ‰€æœ‰ T ç±»å‹çš„å¯¹è±¡éƒ½å¯ä»¥åœ¨ä¸ç ´åç¨‹åºçš„æƒ…å†µä¸‹è¢« S ç±»å‹çš„å¯¹è±¡æ›¿æ¢ã€‚

ç®€å•æ¥è¯´ï¼Œå­—ç±»å¯ä»¥æ‰©å±•çˆ¶ç±»çš„åŠŸèƒ½ï¼Œä½†ä¸èƒ½æ”¹å˜çˆ¶ç±»çš„åŸæœ‰åŠŸèƒ½ã€‚ä¹Ÿå°±è¯´ï¼šå½“å­—ç±»ç»§æ‰¿çˆ¶ç±»æ—¶ï¼Œé™¤æ–°æ·»åŠ æ–°çš„æ–¹æ³•ä¸”å®Œæˆæ–°å¢åŠŸèƒ½å¤–ï¼Œå°½é‡ä¸è¦é‡å†™çˆ¶ç±»çš„æ–¹æ³•ã€‚

- å­ç±»å¯ä»¥å®ç°çˆ¶ç±»çš„æŠ½è±¡æ–¹æ³•ï¼Œä½†ä¸èƒ½è¦†ç›–çˆ¶ç±»çš„éæŠ½è±¡æ–¹æ³•ã€‚
- å­ç±»å¯ä»¥å¢åŠ è‡ªå·±ç‰¹æœ‰çš„æ–¹æ³•ã€‚
- å½“å­ç±»çš„æ–¹æ³•é‡è½½çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œæ–¹æ³•çš„å‰ç½®æ¡ä»¶ï¼ˆå³æ–¹æ³•çš„è¾“å…¥å‚æ•°ï¼‰è¦æ¯”çˆ¶ç±»çš„æ–¹æ³•æ›´å®½æ¾ã€‚
- å½“å­ç±»çš„æ–¹æ³•å®ç°çˆ¶ç±»çš„æ–¹æ³•ï¼ˆé‡å†™ã€é‡è½½æˆ–å®ç°æŠ½è±¡æ–¹æ³•ï¼‰æ—¶ï¼Œæ–¹æ³•çš„åç½®æ¡ä»¶ï¼ˆå³æ–¹æ³•çš„è¾“å‡ºæˆ–è¿”å›å€¼ï¼‰è¦æ¯”çˆ¶ç±»çš„æ–¹æ³•æ›´ä¸¥æ ¼æˆ–ä¸çˆ¶ç±»çš„æ–¹æ³•ç›¸ç­‰ã€‚

**é‡Œæ°æ›¿æ¢åŸåˆ™çš„ä½œç”¨**

- é‡Œæ°æ›¿æ¢åŸåˆ™æ°å®ç°å¼€é—­åŸåˆ™çš„é‡è¦æ–¹å¼ä¹‹ä¸€ã€‚
- è§£å†³äº†ç»§æ‰¿ä¸­é‡å†™çˆ¶ç±»é€ æˆçš„å¯å¤ç”¨æ€§å˜å·®çš„é—®é¢˜ã€‚
- æ˜¯åŠ¨ä½œæ­£ç¡®æ€§çš„ä¿è¯ï¼Œå³ç±»çš„æ‰©å±•ä¸ä¼šç»™å·²æœ‰çš„ç³»ç»Ÿå¼•å…¥æ–°çš„é”™è¯¯ï¼Œé™ä½ä»£ç å‡ºé”™çš„å¯èƒ½æ€§ã€‚
- åŠ å¼ºç¨‹åºçš„å¥å£®æ€§ï¼ŒåŒæ—¶å˜æ›´æ—¶å¯ä»¥åšåˆ°éå¸¸å¥½çš„å…¼å®¹æ€§ï¼Œæé«˜ç¨‹åºçš„ç»´æŠ¤æ€§ã€å¯æ‰©å±•æ€§ï¼Œé™ä½éœ€æ±‚å˜æ›´æ—¶å¼•å…¥çš„é£é™©ã€‚

### æ¨¡æ‹Ÿåœºæ™¯

å‡è®¾åœ¨æ„å»ºé“¶è¡Œç³»ç»Ÿæ—¶ï¼Œå‚¨è“„å¡æ˜¯ç¬¬ä¸€ä¸ªç±»ï¼Œä¿¡ç”¨å¡æ˜¯ç¬¬äºŒä¸ªç±»ã€‚ä¸ºäº†è®©ä¿¡ç”¨å¡å¯ä»¥ä½¿ç”¨å‚¨è“„å¡çš„ä¸€äº›æ–¹æ³•ï¼Œé€‰æ‹©ç”±ä¿¡ç”¨å¡ç»§ç»­å‚¨è“„å¡ç±»ã€‚

#### è¿èƒŒåŸåˆ™æ–¹æ¡ˆ

å‚¨è“„å¡å’Œä¿¡ç”¨å¡åœ¨ä½¿ç”¨åŠŸèƒ½ä¸Šç±»ä¼¼ï¼Œéƒ½æœ‰æ”¯ä»˜ã€æç°ã€è¿˜æ¬¾ã€å……å€¼ç­‰åŠŸèƒ½ï¼Œä¹Ÿæœ‰äº›è®¸ä¸åŒï¼Œä¾‹å¦‚æ”¯ä»˜ã€å‚¨è“„å¡åšçš„æ˜¯è´¦å·æ‰£æ¬¾åŠ¨ä½œï¼Œä¿¡ç”¨å¡åšçš„æ˜¯ç”Ÿæˆè´·æ¬¾å•åŠ¨ä½œã€‚

**1. å‚¨è“„å¡**

åœ¨å‚¨è“„å¡çš„åŠŸèƒ½å®ç°ä¸­åŒ…æ‹¬äº†ä¸‰ä¸ªæ–¹æ³•ï¼šæç°ã€å‚¨è“„ã€äº¤æ˜“æµæ°´æŸ¥è¯¢ã€‚

~~~~ java
public class CashCard {
    private Logger logger = LoggerFactory.getLogger(CashCard.class);

    /**
     * æç°
     * @param orderId å•å·
     * @param amount  é‡‘é¢
     * @return çŠ¶æ€ç  0000 æˆåŠŸã€0001 å¤±è´¥ã€0002 é‡å¤
     */
    public String withdrawal(String orderId, BigDecimal amount){
        //æ¨¡æ‹Ÿæ”¯ä»˜æˆåŠŸ
        logger.info("æç°æˆåŠŸï¼Œå•å·ï¼š{} é‡‘é¢ï¼š{}",orderId,amount);
        return "0000";
    }

    /**
     * å‚¨è“„
     * @param orderId å•å·
     * @param amount  é‡‘é¢
     * @return
     */
    public String recharge(String orderId,BigDecimal amount){
        //æ¨¡æ‹Ÿå……å€¼æˆåŠŸ
        logger.info("å‚¨è“„æˆåŠŸï¼Œå•å·ï¼š{} é‡‘é¢ï¼š{}",orderId,amount);
        return "0000";
    }

    /**
     * äº¤æ˜“æµæ°´æŸ¥è¯¢
     * @return äº¤æ˜“æµæ°´
     */
    public List<String> tradeFlow(){
        logger.info("äº¤æ˜“æµæ°´æŸ¥è¯¢æˆåŠŸ");
        List<String> tradeList = new ArrayList<>();
        tradeList.add("100001,100.00");
        tradeList.add("100001,80.00");
        tradeList.add("100001,76.50");
        tradeList.add("100001,126.00");
        return tradeList;
    }
}

~~~~

**2. ä¿¡ç”¨å¡**

ä¿¡ç”¨å¡çš„åŠŸèƒ½å®ç°æ˜¯åœ¨ç»§æ‰¿å‚¨è“„å¡ç±»åï¼Œè¿›è¡Œæ–¹æ³•é‡å†™ï¼šæ”¯ä»˜withdrawal()ã€è¿˜æ¬¾recharge()ã€‚

~~~~ java
public class CreditCard extends CashCard {

    private Logger logger = LoggerFactory.getLogger(CreditCard.class);

    @Override
    public String withdrawal(String orderId, BigDecimal amount) {
        if (amount.compareTo(new BigDecimal(1000)) >= 0) {
            logger.info("è´·æ¬¾é‡‘é¢æ ¡éªŒï¼ˆé™é¢1000å…ƒï¼‰ï¼Œå•å·ï¼š{} é‡‘é¢ï¼š{}", orderId, amount);
            return "0001";
        }
        //æ¨¡æ‹Ÿç”Ÿæˆè´·æ¬¾å•
        logger.info("ç”Ÿæˆè´·æ¬¾å•ï¼Œå•å·ï¼š{} é‡‘é¢ï¼š{}", orderId, amount);
        //æ¨¡æ‹Ÿæ”¯ä»˜æˆåŠŸ
        logger.info("è´·æ¬¾æˆåŠŸï¼Œå•å·ï¼š{} é‡‘é¢ï¼š{}", orderId, amount);
        return "0000";
    }

    @Override
    public String recharge(String orderId, BigDecimal amount) {
        //æ¨¡æ‹Ÿç”Ÿæˆè¿˜æ¬¾å•
        logger.info("ç”Ÿæˆè¿˜æ¬¾ï¼Œå•å·ï¼š{} é‡‘é¢ï¼š{}",orderId,amount);
        //æ¨¡æ‹Ÿè¿˜æ¬¾æˆåŠŸ
        logger.info("è¿˜æ¬¾æˆåŠŸï¼Œå•å·ï¼š{} é‡‘é¢ï¼š{}",orderId,amount);
        return "0000";
    }

    @Override
    public List<String> tradeFlow() {
        return super.tradeFlow();
    }
~~~~

> è¿™ç§ç»§æ‰¿çˆ¶ç±»æ–¹å¼çš„ä¼˜ç‚¹æ˜¯å¤ç”¨äº†çˆ¶ç±»çš„æ ¸å¿ƒåŠŸèƒ½é€»è¾‘ï¼Œä½†æ˜¯ä¹Ÿç ´åäº†åŸæœ‰çš„æ–¹æ³•ã€‚æ­¤æ—¶ç»§æ‰¿çˆ¶ç±»å®ç°çš„ä¿¡ç”¨å¡ç±»å¹¶ä¸æ»¡è¶³é‡Œæ°æ›¿æ¢åŸåˆ™ã€‚

#### æ”¹å–„æ–¹æ¡ˆ

**1. æŠ½è±¡é“¶è¡Œå¡ç±»**

åœ¨æŠ½è±¡é“¶è¡Œå¡ç±»ä¸­ï¼Œæä¾›åŸºæœ¬å¡å±æ€§ï¼ŒåŒ…æ‹¬å¡å·ã€å¼€å¡æ—¶é—´çº§ä¸‰ä¸ªæ ¸å¿ƒæ–¹æ³•ã€‚æ­£å‘å…¥è´¦ï¼ŒåŠ é’±ï¼›é€†å‘å…¥è´¦ï¼Œå‡é’±ã€‚

~~~~ java
public abstract class BankCard {
    private Logger logger = LoggerFactory.getLogger(CreditCard.class);
    /**
     * å¡å·
     */
    private String cardNo;

    /**
     * å¼€å¡æ—¶é—´
     */
    private String cardDate;

    public BankCard(String cardNo, String cardDate) {
        this.cardNo = cardNo;
        this.cardDate = cardDate;
    }

    /**
     * è§„åˆ™
     *
     * @param amount
     * @return
     */
    abstract boolean rule(BigDecimal amount);

    /**
     * æ­£å‘å…¥è´¦ï¼ŒåŠ é’±
     *
     * @param orderId
     * @param amount
     * @return
     */
    public String positive(String orderId, BigDecimal amount) {
        //å…¥æ¬¾æˆåŠŸï¼Œå­˜æ¬¾ã€è¿˜æ¬¾
        logger.info("å¡å·{} å…¥æ¬¾æˆåŠŸï¼Œå•å·ï¼š{} é‡‘é¢ï¼š{}", cardNo, orderId, amount);
        return "0000";
    }

    /**
     * é€†å‘å…¥è´¦ï¼Œå‡é’±
     *
     * @param orderId
     * @param amount
     * @return
     */
    public String negative(String orderId, BigDecimal amount) {
        logger.info("å¡å·{} å‡ºæ¬¾æˆåŠŸï¼Œå•å·ï¼š{} é‡‘é¢ï¼š{}", cardNo, orderId, amount);
        return "0000";
    }

    /**
     * äº¤æ˜“æµæ°´æŸ¥è¯¢
     * @return äº¤æ˜“æµæ°´
     */
    public List<String> tradeFlow(){
        logger.info("äº¤æ˜“æµæ°´æŸ¥è¯¢æˆåŠŸ");
        List<String> tradeList = new ArrayList<>();
        tradeList.add("100001,100.00");
        tradeList.add("100001,80.00");
        tradeList.add("100001,76.50");
        tradeList.add("100001,126.00");
        return tradeList;
    }

    public String getCardNo() {
        return cardNo;
    }

    public String getCardDate() {
        return cardDate;
    }
}
~~~~

**2. å‚¨è“„å¡ç±»å®ç°**

å‚¨è“„å¡ç±»ä¸­ç»§æ‰¿æŠ½è±¡é“¶è¡Œå¡çˆ¶ç±» BankCardï¼Œå®ç°çš„æ ¸å¿ƒåŠŸèƒ½åŒ…æ‹¬è§„åˆ™è¿‡æ»¤ruleï¼Œæç°withdrawalã€å‚¨è“„recharge å’Œæ–°å¢çš„æ‰©å±•æ–¹æ³•ï¼Œå³é£æ§æ ¡éªŒ checkRiskã€‚

~~~ java
public class CashCard extends BankCard {
    private Logger logger = LoggerFactory.getLogger(CashCard.class);

    public CashCard(String cardNo,String cardDate){
        super(cardNo,cardDate);
    }


    /**
     * è§„åˆ™è¿‡æ»¤ï¼Œå‚¨è“„å¡ç›´æ¥é»˜è®¤é€šè¿‡
     * @param amount
     * @return
     */
    @Override
    boolean rule(BigDecimal amount){
        return true;
    }

    /**
     * æç°
     * @param orderId å•å·
     * @param amount  é‡‘é¢
     * @return çŠ¶æ€ç  0000 æˆåŠŸã€0001 å¤±è´¥ã€0002 é‡å¤
     */
    public String withdrawal(String orderId, BigDecimal amount){
        //æ¨¡æ‹Ÿæ”¯ä»˜æˆåŠŸ
        logger.info("æç°æˆåŠŸï¼Œå•å·ï¼š{} é‡‘é¢ï¼š{}",orderId,amount);
        return super.negative(orderId,amount);
    }

    /**
     * å‚¨è“„
     * @param orderId å•å·
     * @param amount  é‡‘é¢
     * @return
     */
    public String recharge(String orderId,BigDecimal amount){
        //æ¨¡æ‹Ÿå……å€¼æˆåŠŸ
        logger.info("å‚¨è“„æˆåŠŸï¼Œå•å·ï¼š{} é‡‘é¢ï¼š{}",orderId,amount);
        return super.positive(orderId,amount);
    }

    /**
     * é£é™©æ ¡éªŒ
     *
     * @param cardNo  å¡å·
     * @param orderId å•å·
     * @param amount  é‡‘é¢
     * @return çŠ¶æ€
     */
    public boolean checkRisk(String cardNo, String orderId, BigDecimal amount) {
        // æ¨¡æ‹Ÿé£æ§æ ¡éªŒ
        logger.info("é£æ§æ ¡éªŒï¼Œå¡å·ï¼š{} å•å·ï¼š{} é‡‘é¢ï¼š{}", cardNo, orderId, amount);
        return true;
    }
}
~~~

**3. ä¿¡ç”¨å¡ç±»å®ç°**

ä¿¡ç”¨å¡ç±»åœ¨ç»§æ‰¿çˆ¶ç±»åï¼Œä½¿ç”¨å…¬ç”¨å±æ€§ï¼Œå³å¡å· carNoã€å¼€å¡æ—¶é—´ cardDateï¼ŒåŒæ—¶æ–°å¢äº†ç¬¦å·ä¿¡ç”¨å¡åŠŸèƒ½çš„æ–°æ–¹æ³•ï¼Œå³è´·æ¬¾ loanã€è¿˜æ¬¾repaymentï¼Œå¹¶åœ¨ä¸¤ä¸ªæ–¹æ³•ä¸­éƒ½ä½¿ç”¨äº†æŠ½è±¡ç±»çš„æ ¸å¿ƒåŠŸèƒ½ã€‚

~~~ java
public class CreditCard extends BankCard {

    private Logger logger = LoggerFactory.getLogger(CreditCard.class);

    public CreditCard(String cardNo, String cardDate) {
        super(cardNo, cardDate);
    }

    @Override
    boolean rule(BigDecimal amount) {
        return amount.compareTo(new BigDecimal(1000)) <= 0;
    }

    /**
     * æç°ï¼Œä¿¡ç”¨å¡è´·æ¬¾
     *
     * @param orderId å•å·
     * @param amount  é‡‘é¢
     * @return çŠ¶æ€ç 
     */
    public String loan(String orderId, BigDecimal amount) {
        boolean loanRule = rule(amount);
        if (!loanRule) {
            logger.info("ç”Ÿæˆè´·æ¬¾å•å¤±è´¥ï¼Œå•å·ï¼š{} é‡‘é¢ï¼š{}", orderId, amount);
            return "0001";
        }
        //æ¨¡æ‹Ÿç”Ÿæˆè´·æ¬¾å•
        logger.info("ç”Ÿæˆè´·æ¬¾å•ï¼Œå•å·ï¼š{} é‡‘é¢ï¼š{}", orderId, amount);
        //æ¨¡æ‹Ÿæ”¯ä»˜æˆåŠŸ
        logger.info("è´·æ¬¾æˆåŠŸï¼Œå•å·ï¼š{} é‡‘é¢ï¼š{}", orderId, amount);
        return super.negative(orderId, amount);
    }

    /**
     * è¿˜æ¬¾ï¼Œä¿¡ç”¨å¡è¿˜æ¬¾
     *
     * @param orderId å•å·
     * @param amount  é‡‘é¢
     * @return çŠ¶æ€ç 
     */
    public String repayment(String orderId, BigDecimal amount) {
        //æ¨¡æ‹Ÿç”Ÿæˆè¿˜æ¬¾å•
        logger.info("ç”Ÿæˆè¿˜æ¬¾ï¼Œå•å·ï¼š{} é‡‘é¢ï¼š{}", orderId, amount);
        //æ¨¡æ‹Ÿè¿˜æ¬¾æˆåŠŸ
        logger.info("è¿˜æ¬¾æˆåŠŸï¼Œå•å·ï¼š{} é‡‘é¢ï¼š{}", orderId, amount);
        return super.positive(orderId,amount);
    }
}
~~~

## è¿ªç±³ç‰¹æ³•åˆ™åŸåˆ™

### åŸºæœ¬ä»‹ç»

è¿ªç±³ç‰¹æ³•åˆ™ï¼ˆLaw of Demeterï¼ŒLoDï¼‰åˆç§°æœ€å°‘çŸ¥é“åŸåˆ™ï¼Œæ˜¯æŒ‡ä¸€ä¸ªå¯¹è±¡ç±»å¯¹äºå…¶ä»–å¯¹è±¡ç±»æ¥è¯´ï¼ŒçŸ¥é“å¾—è¶Šå°‘è¶Šå¥½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸¤ä¸ªç±»ä¹‹é—´ä¸è¦æœ‰è¿‡å¤šçš„è€¦åˆå…³ç³»ï¼Œä¿æŒæœ€å°‘å…³è”æ€§ã€‚

è¿ªç±³ç‰¹åˆ™æœ‰ä¸€å¥ç»å…¸è¯­å½•ï¼šåªå’Œæœ‹å‹é€šä¿¡ï¼Œä¸å’Œé™Œç”Ÿäººè¯´è¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæœ‰å†…åœ¨å…³è”çš„ç±»è¦å†…èšï¼Œæ²¡æœ‰ç›´æ¥å…³ç³»çš„ç±»è¦ä½è€¦åˆã€‚

### æ¨¡æ‹Ÿåœºæ™¯

æ ¡é•¿æƒ³è¦çŸ¥é“ä¸€ä¸ªç­çº§çš„æ€»åˆ†å’Œå¹³å‡åˆ†ã€‚

#### è¿èƒŒåŸåˆ™æ–¹æ¡ˆ

**1. å­¦ç”Ÿä¿¡æ¯ç±»ï¼ˆå­¦ç”Ÿå§“åã€è€ƒè¯•æ’åã€æ€»åˆ†ï¼‰**

~~~ java
@Data
@NoArgsConstructor
@AllArgsConstructor
public class Student {
    /**
     * å­¦ç”Ÿå§“å
     */
    private String name;
    /**
     * è€ƒè¯•æ’åï¼ˆæ€»æ’åï¼‰
     */
    private int rank;
    /**
     * æ€»åˆ†
     */
    private double grade;
}
~~~

**2. è€å¸ˆç±»**

åœ¨è€å¸ˆç±»é‡Œåˆå§‹åŒ–å­¦ç”Ÿçš„ä¿¡æ¯ï¼Œä»¥åŠæä¾›åŸºæœ¬çš„ä¿¡æ¯è·å–æ¥å£ã€‚

~~~ java
public class Teacher {
    /**
     * è€å¸ˆå§“å
     */
    private String name;
    /**
     * ç­çº§
     */
    private String clazz;
    /**
     * å­¦ç”Ÿäººæ•°
     */
    private static List<Student> studentList;

    public Teacher(String name, String clazz) {
        this.name = name;
        this.clazz = clazz;
    }

    static {
        studentList = new ArrayList<>();
        studentList.add(new Student("èŠ±èŠ±", 10, 589));
        studentList.add(new Student("è±†è±†", 54, 356));
        studentList.add(new Student("ç§‹é›…", 23, 439));
        studentList.add(new Student("çš®çš®", 2, 665));
        studentList.add(new Student("è›‹è›‹", 19, 502));
    }

    public String getName() {
        return name;
    }

    public String getClazz() {
        return clazz;
    }

    public static List<Student> getStudentList() {
        return studentList;
    }
}
~~~

**3. æ ¡é•¿ç±»**

æ ¡é•¿ç®¡ç†å…¨å±€ï¼Œå¹¶åœ¨æ ¡é•¿ç±»ä¸­è·å–å­¦ç”Ÿäººæ•°ã€æ€»åˆ†ã€å¹³å‡åˆ†ç­‰ã€‚

~~~ java
public class Principal {
    private Teacher teacher = new Teacher("æå", "3å¹´çº§1ç­");

    /**
     * æŸ¥è¯¢ç­çº§ä¿¡æ¯ï¼Œæ€»åˆ†ã€å­¦ç”Ÿäººæ•°ã€å¹³å‡åˆ†
     *
     * @param clazzId
     * @return
     */
    public Map<String, Object> queryClazzInfo(String clazzId) {
        // è·å–ç­çº§ä¿¡æ¯ï¼šå­¦ç”Ÿäººæ•°ã€æ€»åˆ†ã€å¹³å‡åˆ†
        int stuCount = clazzStudentCount();
        double totalScore = clazzTotalScore();
        double averageScore = clazzAverageScore();
        // ç»„è£…å¯¹è±¡
        Map<String, Object> mapObj = new HashMap<>();
        mapObj.put("ç­çº§",teacher.getClazz());
        mapObj.put("è€å¸ˆå§“å",teacher.getName());
        mapObj.put("å­¦ç”Ÿäººæ•°",stuCount);
        mapObj.put("æ€»åˆ†",totalScore);
        mapObj.put("å¹³å‡åˆ†",averageScore);
        return mapObj;
    }

    /**
     * æ€»åˆ†
     *
     * @return
     */
    public double clazzTotalScore() {
        double totalScore = 0;
        for (Student stu : teacher.getStudentList()) {
            totalScore += stu.getGrade();
        }
        return totalScore;
    }

    /**
     * å¹³å‡åˆ†
     *
     * @return
     */
    public double clazzAverageScore() {
        double totalScore = 0;
        for (Student stu : teacher.getStudentList()) {
            totalScore += stu.getGrade();
        }
        return totalScore / teacher.getStudentList().size();
    }

    /**
     * ç­çº§äººæ•°
     *
     * @return
     */
    public int clazzStudentCount() {
        return teacher.getStudentList().size();
    }
}
~~~

> ä»¥ä¸Šå°±æ˜¯é€šè¿‡æ ¡é•¿ç®¡ç†æ‰€æœ‰å­¦ç”Ÿï¼Œè€å¸ˆåªæä¾›äº†éå¸¸ç®€å•çš„ä¿¡æ¯ã€‚è™½ç„¶å¯ä»¥æŸ¥è¯¢ç»“æœï¼Œä½†æ˜¯è¿èƒŒäº†è¿ªç±³ç‰¹æ³•åˆ™ï¼Œå› ä¸ºæ ¡é•¿éœ€è¦äº†è§£æ¯ä¸ªå­¦ç”Ÿæƒ…å†µã€‚å¦‚æœæ‰€æœ‰ç­çº§éƒ½è®©æ ¡é•¿ç±»ç»Ÿè®¡ï¼Œä»£ç å°±ä¼šå˜å¾—éå¸¸è‡ƒè‚¿ï¼Œä¹Ÿä¸æ˜“äºç»´æŠ¤å’Œæ‰©å±•ã€‚

#### æ”¹å–„æ–¹æ¡ˆ

ä¸è¯¥è®©æ ¡é•¿ç›´æ¥ç®¡ç†å­¦ç”Ÿï¼Œæ ¡é•¿åº”è¯¥ç®¡ç†è€å¸ˆï¼Œç”±è€å¸ˆæä¾›ç›¸åº”çš„å­¦ç”Ÿä¿¡æ¯æŸ¥è¯¢æœåŠ¡ã€‚

**1. è€å¸ˆç±»**

~~~ java
public class Teacher {
    /**
     * è€å¸ˆå§“å
     */
    private String name;
    /**
     * ç­çº§
     */
    private String clazz;
    /**
     * å­¦ç”Ÿäººæ•°
     */
    private static List<Student> studentList;

    public Teacher() {
    }

    public Teacher(String name, String clazz) {
        this.name = name;
        this.clazz = clazz;
    }

    static {
        studentList = new ArrayList<>();
        studentList.add(new Student("èŠ±èŠ±", 10, 589));
        studentList.add(new Student("è±†è±†", 54, 356));
        studentList.add(new Student("ç§‹é›…", 23, 439));
        studentList.add(new Student("çš®çš®", 2, 665));
        studentList.add(new Student("è›‹è›‹", 19, 502));
    }

    /**
     * æ€»åˆ†
     *
     * @return
     */
    public double clazzTotalScore() {
        double totalScore = 0;
        for (Student stu : studentList) {
            totalScore += stu.getGrade();
        }
        return totalScore;
    }

    /**
     * å¹³å‡åˆ†
     *
     * @return
     */
    public double clazzAverageScore() {
        double totalScore = 0;
        for (Student stu : studentList) {
            totalScore += stu.getGrade();
        }
        return totalScore / studentList.size();
    }

    /**
     * ç­çº§äººæ•°
     *
     * @return
     */
    public int clazzStudentCount() {
        return studentList.size();
    }

    public String getName() {
        return name;
    }

    public String getClazz() {
        return clazz;
    }

    public static List<Student> getStudentList() {
        return studentList;
    }
}
~~~

**2. æ ¡é•¿ç±»**

~~~ java
public class Principal {
    private Teacher teacher = new Teacher("æå", "3å¹´çº§1ç­");

    /**
     * æŸ¥è¯¢ç­çº§ä¿¡æ¯ï¼Œæ€»åˆ†ã€å­¦ç”Ÿäººæ•°ã€å¹³å‡åˆ†
     *
     * @param clazzId
     * @return
     */
    public Map<String, Object> queryClazzInfo(String clazzId) {
        // è·å–ç­çº§ä¿¡æ¯ï¼šå­¦ç”Ÿäººæ•°ã€æ€»åˆ†ã€å¹³å‡åˆ†
        int stuCount = teacher.clazzStudentCount();
        double totalScore = teacher.clazzTotalScore();
        double averageScore = teacher.clazzAverageScore();
        // ç»„è£…å¯¹è±¡
        Map<String, Object> mapObj = new HashMap<>();
        mapObj.put("ç­çº§",teacher.getClazz());
        mapObj.put("è€å¸ˆå§“å",teacher.getName());
        mapObj.put("å­¦ç”Ÿäººæ•°",stuCount);
        mapObj.put("æ€»åˆ†",totalScore);
        mapObj.put("å¹³å‡åˆ†",averageScore);
        return mapObj;
    }
}
~~~

## æ¥å£éš”ç¦»åŸåˆ™

### åŸºæœ¬ä»‹ç»

æ¥å£éš”ç¦»åŸåˆ™ï¼ˆInterface Segregation Principleï¼ŒISPï¼‰è¦æ±‚ç¨‹åºå‘˜å°½é‡å°†è‡ƒè‚¿åºå¤§çš„æ¥å£æ‹†åˆ†æˆæ›´å°çš„å’Œæ›´å…·ä½“çš„æ¥å£ï¼Œè®©æ¥å£ä¸­åªåŒ…å«å®¢æˆ·æ„Ÿå…´è¶£çš„æ–¹æ³•ã€‚

æ¥å£éš”ç¦»æ˜¯ä¸ºäº†é«˜å†…èšã€ä½è€¦åˆã€‚åœ¨å®é™…çš„ä¸šåŠ¡å¼€å‘ä¸­ï¼Œé€šå¸¸ä¼šå…ˆå®šä¹‰å¥½éœ€è¦å¼€å‘çš„æ¥å£ï¼Œå¹¶ç”±å„ä¸ªæœåŠ¡ç±»å®ç°ã€‚ä½†å¦‚æœæ²¡æœ‰ç»è¿‡è€ƒè™‘å’Œè®¾è®¡ï¼Œå°±å¾ˆå¯èƒ½é€ æˆä¸€ä¸ªæ¥å£ä¸­åŒ…æ‹¬ä¼—å¤šçš„æ¥å£æ–¹æ³•ï¼Œè€Œè¿™äº›æ¥å£å¹¶ä¸ä¸€å®šåœ¨æ¯ä¸€ä¸ªç±»ä¸­éƒ½éœ€è¦å®ç°ã€‚è¿™æ ·çš„æ¥å£å¾ˆéš¾ç»´æŠ¤ï¼Œä¹Ÿä¸æ˜“äºæ‰©å±•ï¼Œæ¯ä¸€æ¬¡ä¿®æ”¹éªŒè¯éƒ½æœ‰æ½œåœ¨çš„é£é™©ã€‚

åœ¨å…·ä½“åº”ç”¨æ¥å£éš”ç¦»åŸåˆ™æ—¶ï¼Œåº”è¯¥æ ¹æ®ä»¥ä¸‹å‡ ä¸ªè§„åˆ™è¡¡é‡ã€‚

- æ¥å£å°½é‡å°ï¼Œä½†æ˜¯è¦æœ‰é™åº¦ã€‚ä¸€ä¸ªæ¥å£åªæœåŠ¡äºä¸€ä¸ªå­æ¨¡å—æˆ–ä¸šåŠ¡é€»è¾‘ã€‚
- ä¸ºä¾èµ–æ¥å£çš„ç±»å®šåˆ¶æœåŠ¡ã€‚åªæä¾›è°ƒç”¨è€…éœ€è¦çš„æ–¹æ³•ï¼Œå±è”½ä¸éœ€è¦çš„æ–¹æ³•ã€‚
- äº†è§£ç¯å¢ƒï¼Œæ‹’ç»ç›²ä»ã€‚æ¯ä¸ªé¡¹ç›®æˆ–äº§å“éƒ½æœ‰é€‰å®šçš„ç¯å¢ƒå› ç´ ï¼Œç¯å¢ƒä¸åŒï¼Œæ¥å£æ‹†åˆ†çš„æ ‡å‡†å°±ä¸åŒï¼Œè¦æ·±å…¥äº†è§£ä¸šåŠ¡é€»è¾‘ã€‚
- æé«˜å†…èšï¼Œå‡å°‘å¯¹å¤–äº¤äº’ã€‚è®©æ¥å£ç”¨æœ€å°‘çš„æ–¹æ³•å®Œæˆæœ€å¤šçš„äº‹æƒ…ã€‚

### æ¨¡æ‹Ÿåœºæ™¯

ã€Šç‹è€…è£è€€ã€‹é‡Œæœ‰å¾ˆå¤šè‹±é›„ï¼Œå¯ä»¥åˆ†ä¸ºå°„æ‰‹ã€æˆ˜å£«ã€åˆºå®¢ï¼Œæ¯ä¸ªè‹±é›„æœ‰ä¸‰ç§æŠ€èƒ½ï¼Œè¿™äº›æŠ€èƒ½è¯¥å¦‚ä½•å®šä¹‰ï¼Œè®©æ¯ä¸ªè‹±é›„å®ç°ç›¸åº”çš„æŠ€èƒ½æ•ˆæœã€‚

#### è¿èƒŒåŸåˆ™æ–¹æ¡ˆ

**1. æŠ€èƒ½æ¥å£**

å®šä¹‰ä¸€ä¸ªæŠ€èƒ½æ¥å£ï¼Œå®ç°çš„è‹±é›„éƒ½éœ€è¦å®ç°è¿™ä¸ªæ¥å£ï¼Œè¿›è€Œå®ç°è‡ªå·±çš„æŠ€èƒ½ã€‚

~~~ java
public interface ISkill {
    /**
     * å°„ç®­
     */
    void doArchery();

    /**
     * éšè¢­
     */
    void doInvisible();

    /**
     * æ²‰é»˜
     */
    void  doSilent();

    /**
     * çœ©æ™•
     */
    void doVertigo();
}
~~~

**2. è‹±é›„åè£”**

åœ¨è‹±é›„åè£”çš„ç±»ä¸­ï¼Œå®ç°äº†ä¸‰ä¸ªæŠ€èƒ½ï¼Œæœ€åä¸€ä¸ªçœ©æ™•çš„æŠ€èƒ½æ˜¯ä¸éœ€è¦å®ç°çš„ã€‚

~~~ java
public class HeroHouYi implements ISkill {
    @Override
    public void doArchery() {
        System.out.println("åè£”çš„ç¼æ—¥ä¹‹çŸ¢");
    }

    @Override
    public void doInvisible() {
        System.out.println("åè£”çš„éšèº«æŠ€èƒ½");
    }

    @Override
    public void doSilent() {
        System.out.println("åè£”çš„æ²‰é»˜æŠ€èƒ½");
    }

    @Override
    public void doVertigo() {
        // æ— æ­¤æŠ€èƒ½çš„å®ç°
    }
}
~~~

**3. è‹±é›„å»‰é¢‡**

åœ¨è‹±é›„å»‰é¢‡çš„ç±»ä¸­ï¼ŒåŒæ ·åªå®ç°äº†ä¸‰ä¸ªæŠ€èƒ½ï¼Œæœ‰ä¸€ä¸ªå°„ç®­çš„æŠ€èƒ½æ²¡æœ‰å®ç°ã€‚

~~~ java
public class HeroLianPo implements ISkill{

    @Override
    public void doArchery() {
        // æ— æ­¤æŠ€èƒ½çš„å®ç°
    }

    @Override
    public void doInvisible() {
        System.out.println("å»‰é¢‡çš„éšèº«æŠ€èƒ½");
    }

    @Override
    public void doSilent() {
        System.out.println("å»‰é¢‡çš„æ²‰é»˜æŠ€èƒ½");
    }

    @Override
    public void doVertigo() {
        System.out.println("å»‰é¢‡çš„çœ©æ™•æŠ€èƒ½");
    }

}
~~~

#### æ”¹å–„æ–¹æ¡ˆ

æŒ‰ç…§æ¥å£éš”ç¦»åŸåˆ™çš„çº¦å®šï¼Œåº”è¯¥åœ¨ç¡®ä¿åˆç†çš„æƒ…å†µä¸‹ï¼ŒæŠŠæ¥å£ç»†åˆ†ã€‚ä¿è¯ä¸€ä¸ªæ¾æ•£çš„ç»“æ„ï¼Œä¹Ÿå°±æ˜¯æŠŠæŠ€èƒ½æ‹†åˆ†å‡ºæ¥ï¼Œæ¯ä¸ªè‹±é›„éƒ½å¯ä»¥æŒ‰éœ€ç»§æ‰¿å®ç°ã€‚

**1. å°„ç®­æ¥å£**

~~~ java
public interface ISkillArchery {
    //ç¼æ—¥ä¹‹çŸ¢
    void doArchery();
}
~~~

**2. éšèº«æ¥å£**

~~~ java
public interface ISkillInvisible {
    // éšè¢­
    void doInvisible();
}
~~~

**3. æ²‰é»˜æ¥å£**

~~~~ java
public interface ISkillSilent {
    // æŠ€èƒ½æ²‰é»˜
    void doSilent();
}
~~~~

**4. çœ©æ™•æ¥å£**

~~~ java
public interface ISkillVertigo {
    // çœ©æ™•
    void doVertigo();
}
~~~

**5. è‹±é›„åç¾¿çš„å®ç°**

~~~ java
public class HeroHouYi implements ISkillArchery, ISkillInvisible, ISkillSilent {

    @Override
    public void doArchery() {
        System.out.println("åè£”çš„ç¼æ—¥ä¹‹çŸ¢");
    }

    @Override
    public void doInvisible() {
        System.out.println("åè£”çš„éšèº«æŠ€èƒ½");
    }

    @Override
    public void doSilent() {
        System.out.println("åè£”çš„æ²‰é»˜æŠ€èƒ½");
    }
}
~~~

**6. è‹±é›„å»‰é¢‡çš„å®ç°**

~~~ java
public class HeroLianPo implements ISkillInvisible, ISkillSilent, ISkillVertigo {

    @Override
    public void doInvisible() {
        System.out.println("å»‰é¢‡çš„éšèº«æŠ€èƒ½");
    }

    @Override
    public void doSilent() {
        System.out.println("å»‰é¢‡çš„æ²‰é»˜æŠ€èƒ½");
    }

    @Override
    public void doVertigo() {
        System.out.println("å»‰é¢‡çš„çœ©æ™•æŠ€èƒ½");
    }

}
~~~

> ç°åœ¨å¯ä»¥çœ‹åˆ°è¿™ä¸¤ä¸ªè‹±é›„çš„ç±»éƒ½æŒ‰éœ€å®ç°äº†è‡ªå·±éœ€è¦çš„æŠ€èƒ½æ¥å£ã€‚è¿™æ ·çš„å®ç°æ–¹å¼å°±å¯ä»¥é¿å…ä¸€äº›æœ¬èº«ä¸å±äºè‡ªå·±çš„æŠ€èƒ½è¿˜éœ€è¦ä¸æ–­åœ°ç”¨æ–‡æ¡£çš„æ–¹å¼è¿›è¡Œç»´æŠ¤ï¼ŒåŒæ—¶æé«˜äº†ä»£ç çš„å¯é æ€§ï¼Œåœ¨åˆ«äººæˆ–ä¿®æ”¹æ—¶ï¼Œå¯ä»¥é™ä½å¼€å‘æˆæœ¬å’Œç»´æŠ¤é£é™©ã€‚

## ä¾èµ–å€’ç½®åŸåˆ™

### åŸºæœ¬ä»‹ç»

ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDependence Inversion Principleï¼ŒDIPï¼‰æ˜¯æŒ‡åœ¨è®¾è®¡ä»£ç æ¶æ„æ—¶ï¼Œé«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–äºåº•å±‚æ¨¡å—ï¼ŒäºŒè€…éƒ½åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚æŠ½è±¡ä¸åº”è¯¥ä¾èµ–äºç»†èŠ‚ï¼Œç»†èŠ‚åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚

ä¾èµ–å€’ç½®åŸåˆ™æ˜¯å®ç°å¼€é—­åŸåˆ™çš„é‡è¦é€”ç»ä¹‹ä¸€ï¼Œå®ƒé™ä½äº†ç±»ä¹‹é—´çš„è€¦åˆï¼Œæé«˜äº†ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯ç»´æŠ¤æ€§ï¼ŒåŒæ—¶è¿™æ ·çš„ä»£ç ä¸€èˆ¬æ›´æ˜“è¯»ï¼Œä¸”ä¾¿äºä¼ æ‰¿ã€‚

### æ¨¡æ‹Ÿåœºæ™¯

åœ¨äº’è”ç½‘çš„è¥é”€æ´»åŠ¨ä¸­ï¼Œç»å¸¸ä¸ºäº†æ‹‰æ–°å’Œä¿ƒæ´»ï¼Œä¼šåšä¸€äº›æŠ½å¥–æ´»åŠ¨ã€‚è¿™äº›æŠ½å¥–æ´»åŠ¨çš„è§„åˆ™ä¼šéšç€ä¸šåŠ¡çš„ä¸æ–­å‘å±•è€Œè°ƒæ•´ï¼Œå¦‚éšæœºæŠ½å¥–ã€æƒé‡æŠ½å¥–ç­‰ã€‚å…¶ä¸­ï¼Œæƒé‡æ˜¯æŒ‡ç”¨æˆ·åœ¨å½“å‰ç³»ç»Ÿä¸­ä¸€ä¸ªç»¼åˆæ’åï¼Œæ¯”å¦‚æ´»è·ƒåº¦ã€è´¡çŒ®åº¦ç­‰ã€‚

**1. å®šä¹‰æŠ½å¥–ç”¨æˆ·ç±»**

~~~ java
@Data
@NoArgsConstructor
@AllArgsConstructor
public class BetUser {
    /**
     * ç”¨æˆ·å§“å
     */
    private String userName;
    /**
     * ç”¨æˆ·æƒé‡
     */
    private int userWeight;
}
~~~

**2. æŠ½å¥–é€»è¾‘å®ç°**

~~~ java
public class DrawControl {

    // éšæœºæŠ½å–æŒ‡å®šæ•°é‡çš„ç”¨æˆ·ï¼Œä½œä¸ºä¸­å¥–ç”¨æˆ·
    public List<BetUser> doDrawRandom(List<BetUser> list, int count) {
        // é›†åˆæ•°é‡å¾ˆå°ç›´æ¥è¿”å›
        if (list.size() <= count) return list;
        // ä¹±åºé›†åˆ
        Collections.shuffle(list);
        // å–å‡ºæŒ‡å®šæ•°é‡çš„ä¸­å¥–ç”¨æˆ·
        List<BetUser> prizeList = new ArrayList<>(count);
        for (int i = 0; i < count; i++) {
            prizeList.add(list.get(i));
        }
        return prizeList;
    }

    // æƒé‡æ’åè·å–æŒ‡å®šæ•°é‡çš„ç”¨æˆ·ï¼Œä½œä¸ºä¸­å¥–ç”¨æˆ·
    public List<BetUser> doDrawWeight(List<BetUser> list, int count) {
        // æŒ‰ç…§æƒé‡æ’åº
        list.sort((o1, o2) -> {
            int e = o2.getUserWeight() - o1.getUserWeight();
            if (0 == e) return 0;
            return e > 0 ? 1 : -1;
        });
        // å–å‡ºæŒ‡å®šæ•°é‡çš„ä¸­å¥–ç”¨æˆ·
        List<BetUser> prizeList = new ArrayList<>(count);
        for (int i = 0; i < count; i++) {
            prizeList.add(list.get(i));
        }
        return prizeList;
    }
}
~~~

> ä¸Šè¿°æ–¹æ¡ˆçš„ç¼ºç‚¹ï¼šå®ç°æ–¹å¼æ‰©å±•èµ·æ¥å¾ˆéº»çƒ¦ï¼Œæ¯æ¬¡æ‰©å±•éƒ½éœ€è¦æ–°å¢æ¥å£ï¼ŒåŒæ—¶å¯¹äºè°ƒç”¨æ–¹æ¥è¯´éœ€è¦æ–°å¢è°ƒç”¨æ¥å£çš„ä»£ç ã€‚å…¶æ¬¡ï¼Œå¯¹äºè¿™ä¸ªæœåŠ¡ç±»æ¥è¯´ï¼Œéšç€æ¥å£æ•°é‡çš„å¢åŠ ï¼Œä»£ç è¡Œæ•°ä¼šä¸æ–­åœ°æš´å¢ï¼Œæœ€åä¼šéš¾ä»¥ç»´æŠ¤ã€‚

#### æ”¹å–„æ–¹æ¡ˆ

**1. æŠ½å¥–åŠŸèƒ½æ¥å£**

æŠ½å¥–æ¥å£ä¸­åŒ…æ‹¬äº†éœ€è¦ä¼ è¾“çš„ list é›†åˆï¼Œä»¥åŠä¸­å¥–ç”¨æˆ·æ•°é‡ã€‚

~~~ java
public interface IDraw {
    // è·å–ä¸­å¥–ç”¨æˆ·æ¥å£
    List<BetUser> prize(List<BetUser> list, int count);
}
~~~

**2. éšæœºæŠ½å¥–ç±»**

~~~ java
public class DrawRandom implements IDraw {

    @Override
    public List<BetUser> prize(List<BetUser> list, int count) {
        // é›†åˆæ•°é‡å¾ˆå°ç›´æ¥è¿”å›
        if (list.size() <= count) return list;
        // ä¹±åºé›†åˆ
        Collections.shuffle(list);
        // å–å‡ºæŒ‡å®šæ•°é‡çš„ä¸­å¥–ç”¨æˆ·
        List<BetUser> prizeList = new ArrayList<>(count);
        for (int i = 0; i < count; i++) {
            prizeList.add(list.get(i));
        }
        return prizeList;
    }

}
~~~

**3. æƒé‡æŠ½å¥–ç±»**

~~~~ java
public class DrawWeightRank implements IDraw {

    @Override
    public List<BetUser> prize(List<BetUser> list, int count) {
        // æŒ‰ç…§æƒé‡æ’åº
        list.sort((o1, o2) -> {
            int e = o2.getUserWeight() - o1.getUserWeight();
            if (0 == e) return 0;
            return e > 0 ? 1 : -1;
        });
        // å–å‡ºæŒ‡å®šæ•°é‡çš„ä¸­å¥–ç”¨æˆ·
        List<BetUser> prizeList = new ArrayList<>(count);
        for (int i = 0; i < count; i++) {
            prizeList.add(list.get(i));
        }
        return prizeList;
    }
}
~~~~

**4. åˆ›å»ºæŠ½å¥–æœåŠ¡**

~~~ java
public class DrawControl {

    private IDraw draw;

    public List<BetUser> doDraw(IDraw draw, List<BetUser> betUserList, int count) {
        return draw.prize(betUserList, count);
    }
}
~~~

**5. æµ‹è¯•**

~~~ java
@Test
public void test_DrawControl() {

        List<BetUser> betUserList = new ArrayList<>();
        betUserList.add(new BetUser("èŠ±èŠ±", 65));
        betUserList.add(new BetUser("è±†è±†", 43));
        betUserList.add(new BetUser("å°ç™½", 72));
        betUserList.add(new BetUser("ç¬¨ç¬¨", 89));
        betUserList.add(new BetUser("ä¸‘è›‹", 10));

        DrawControl drawControl = new DrawControl();
        List<BetUser> prizeRandomUserList = drawControl.doDraw(new DrawRandom(), betUserList, 3);
        logger.info("éšæœºæŠ½å¥–ï¼Œä¸­å¥–ç”¨æˆ·åå•ï¼š{}", JSON.toJSON(prizeRandomUserList));

        List<BetUser> prizeWeightUserList = drawControl.doDraw(new DrawWeightRank(), betUserList, 3);
        logger.info("æƒé‡æŠ½å¥–ï¼Œä¸­å¥–ç”¨æˆ·åå•ï¼š{}", JSON.toJSON(prizeWeightUserList));
 }
~~~

